"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.executeLineageQuery = executeLineageQuery;
const log_1 = require("../../../util/log");
const repl_lineage_1 = require("../../../cli/repl/commands/repl-lineage");
function executeLineageQuery({ dataflow: { graph }, ast }, queries) {
    const start = Date.now();
    const result = {};
    for (const { criterion } of queries) {
        if (result[criterion]) {
            log_1.log.warn('Duplicate criterion in lineage query:', criterion);
        }
        result[criterion] = (0, repl_lineage_1.getLineage)(criterion, graph, ast.idMap);
    }
    return {
        '.meta': {
            timing: Date.now() - start
        },
        lineages: result
    };
}
//# sourceMappingURL=lineage-query-executor.js.map